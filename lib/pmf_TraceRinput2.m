function [hstruct] = pmf_TraceRinput2(fignum, SrcStruct1, SrcStruct2, series1, series2, sweep, yoffset)
%UNTITLED6 Summary of this function goes here
%   Detailed explanation goes here
% 
% Copyright (C) 2016 by Yuichi Takeuchi

% Parameters
fontname = 'Arial';
fontsize = 8;

hfig = figure(fignum);
for k = 1:3
    haxes(k) = subplot(3, 1, k);
    haxes(k).Visible = 'off';
end

xwave = linspace(0, 5.7, 114000);

for k = 1:3
    hold(haxes(k), 'on')
end

for k = sweep
    for l = 1:2
        eval(['SrcWave = SrcStruct' num2str(l) '(series' num2str(l) ').Voltage{k,1};'])
        SrcWave = SrcWave - yoffset * (k - 1);
        plot(haxes(l), xwave, SrcWave, 'k', 'LineWidth', 0.4)
    end
end

SrcWave = zeros(114000,1);
for m = 1:3
    SrcWave([(6000+6000*m+1):(12000+6000*m),...
        (42000+6000*m+1):(48000+6000*m),...
        (78000+6000*m+1):(84000+6000*m)]) = -30e-12*m;
end
plot(haxes(3), xwave, SrcWave, 'k', 'LineWidth', 0.4)

for k = 1:3
    hold(haxes(k), 'off')
end

set(hfig,...
    'PaperUnits', 'centimeters',...
    'PaperPosition', [7 7 15 10]...
    );

set(haxes,...
    'XLim', [0 5.7],...
    'FontName', fontname,...
    'FontSize', fontsize...
    );

set(haxes(1),...
    'YLim', [-.225 -.05]...
    );

set(haxes(2),...
    'Position',...
    [0.13 0.493259113504557 0.775000000000001 0.212247824388886],...
    'YLim', [-.225 -.05]...
    );

set(haxes(3),...
    'YLim', [-90E-12 0]...
    );

figure1 = hfig;
% Create line
annotation(figure1,'line',[0.675243393602225 0.810848400556327],...
    [0.0800810810810821 0.0800811891891892]);

% Create textbox
annotation(figure1,'textbox',...
    [0.677437641723356 0.0395049299439819 0.132086167800454 0.0337837831796827],...
    'String',{'1 s'},...
    'HorizontalAlignment','center',...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.01080452652376 0.952558116948351 0.388563654483583 0.0391891884239942],...
    'String',{'Membrane pontential'},...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0 0.349963927038389 0.394054794081511 0.0391891884239944],...
    'String',{'Injected currents'},...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.84209856430099 0.489852778870156 0.090727105870942 0.0337837831796824],...
    'String','50 mV',...
    'HorizontalAlignment','center',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create line
annotation(figure1,'line',[0.913254375937366 0.913147434301702],...
    [0.21830985915493 0.148574967812414]);

% Create line
annotation(figure1,'line',[0.913200905119534 0.913200905119534],...
    [0.518406956164873 0.459507042253522]);

% Create textbox
annotation(figure1,'textbox',...
    [0.842227862872404 0.153284671532847 0.0915793647571829 0.0582660000193271],...
    'String',{'30 pA'},...
    'HorizontalAlignment','center',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.417375383888497 0.414310858650386 0.200113378684807 0.0337837831796823],...
    'String','+400 µA',...
    'HorizontalAlignment','center',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.663832199546486 0.412550295270104 0.200680272108843 0.0337837831796823],...
    'String','-400 µA',...
    'HorizontalAlignment','center',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create line
annotation(figure1,'line',[0.661335187760776 0.865090403337968],...
    [0.465441710729959 0.465441710729959],'LineWidth',2);

% Create line
annotation(figure1,'line',[0.415855354659248 0.619610570236441],...
    [0.465441710729959 0.465441710729959],'LineWidth',2);

% Create textbox
annotation(figure1,'textbox',...
    [0 0.692804338805037 0.388563654483584 0.0391891884239941],...
    'String','skull',...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0 0.928790511314548 0.388563654483583 0.0391891884239942],...
    'String','skin',...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

hstruct.hfig = hfig;
hstruct.haxes = haxes;

% hstruct.hxlabel = hxlabel;
% hstruct.hylabel = hylabel;
% hstruct.htitle = htitle;
% hstruct.hlegend = hlegend;