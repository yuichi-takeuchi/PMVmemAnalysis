function [hstruct] = pmf_TraceGain2(fignum, SrcStruct1, SrcStruct2, series1, series2, sweep)
%UNTITLED6 Summary of this function goes here
%   Detailed explanation goes here
% 
% Copyright (C) 2016 by Yuichi Takeuchi

% Parameters
fontname = 'Arial';
fontsize = 8;

hfig = figure(fignum);
xwave = linspace(0, 1, 20000);

for k = 1:9
    haxes(k) = subplot(3, 3, k);
    haxes(k).Visible = 'off';
    hold(haxes(k), 'on')
end

for l = 1:3
    mm = 1;
    for m = sweep
        SrcWave = SrcStruct1(series1).Voltage{m,1}((1e4+8e4*(l-1)+1):(3e4+8e4*(l-1)));
        plot(haxes(l), xwave, SrcWave, 'k', 'LineWidth', 0.3)
        SrcWave = SrcStruct2(series2).Voltage{m,1}((1e4+8e4*(l-1)+1):(3e4+8e4*(l-1)));
        plot(haxes(l+3), xwave, SrcWave, 'k', 'LineWidth', 0.3)
        SrcWave = zeros(20000,1);
        SrcWave(5001:15000) = 30e-12*mm;
        plot(haxes(l+6), xwave, SrcWave, 'k', 'LineWidth', 0.4)
        mm = mm + 1;
    end
end

for k = 1:9
    hold(haxes(k), 'off')
end

set(hfig,...
    'PaperUnits', 'centimeters',...
    'PaperPosition', [7 7 16 9]...
    );

set(haxes,...
    'YLim', [-.08 -0.01],...
    'FontName', fontname,...
    'FontSize', fontsize...
    );

set(haxes(4),...
    'Position',[0.13 0.447015530511269 0.213405797101449 0.215735294117647]...
    );

set(haxes(5),...
    'Position',[0.410797101449275 0.447015530511269 0.213405797101449 0.215735294117647]...
    );

set(haxes(6),...
    'Position',[0.691594202898551 0.447015530511269 0.213405797101449 0.215735294117647]...
    );

set(haxes(7:9),...
    'YLim', [0 90e-12]...
    );

   %{
set(hxlabel,...
    'HorizontalAlignment', 'center'...
    );

set(hylabel,...
    'HorizontalAlignment', 'center'...
    );
    %}

figure1 = hfig;
annotation(figure1,'textbox',...
    [0.01080452652376 0.952558116948351 0.388563654483583 0.0391891884239942],...
    'String',{'Membrane pontential'},...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0 0.349963927038389 0.394054794081511 0.0391891884239944],...
    'String',{'Injected currents'},...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create line
annotation(figure1,'line',[0.899723196637986 0.899616255002322],...
    [0.212702382519416 0.1429674911769]);

% Create line
annotation(figure1,'line',[0.899669725820154 0.899669725820154],...
    [0.673285198555956 0.604693140794223]);

% Create textbox
annotation(figure1,'textbox',...
    [0.676279740447008 0.14674261545808 0.222782984859404 0.0582660000193271],...
    'String',{'30 pA'},...
    'HorizontalAlignment','right',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.681326604181687 0.610108303249097 0.21689200038101 0.0615426992339541],...
    'String','20 mV',...
    'HorizontalAlignment','right',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create line
annotation(figure1,'line',[0.744457524820677 0.850757029560199],...
    [0.0838193988380913 0.0838193988380913]);

% Create textbox
annotation(figure1,'textbox',...
    [0.692141312184571 0.0224299065420561 0.224224945926458 0.0602046009741318],...
    'String','500 ms',...
    'HorizontalAlignment','center',...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.00702956020187397 0.676558851440416 0.376306985413648 0.039189188423994],...
    'String','skull',...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.00522710886806055 0.900360908426461 0.379911888081275 0.0391891884239942],...
    'String','skin',...
    'HorizontalAlignment','center',...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create line
annotation(figure1,'line',[0.412250451991614 0.627253064167265],...
    [0.44150365613972 0.44150365613972],'LineWidth',2);

% Create line
annotation(figure1,'line',[0.692337350702373 0.907337350702373],...
    [0.44150365613972 0.44150365613972],'LineWidth',2);

% Create textbox
annotation(figure1,'textbox',...
    [0.135832485546747 0.378600121118029 0.200113378684807 0.0554953638517274],...
    'String','control',...
    'HorizontalAlignment','center',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.415933422821441 0.378600121118029 0.200113378684808 0.0554953638517274],...
    'String','+800 µA',...
    'HorizontalAlignment','center',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.699881226222763 0.377675348656546 0.200680272108843 0.0573449087746946],...
    'String','-800 µA',...
    'HorizontalAlignment','center',...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor','none');

hstruct.hfig = hfig;
hstruct.haxes = haxes;

% hstruct.hxlabel = hxlabel;
% hstruct.hylabel = hylabel;
% hstruct.htitle = htitle;
% hstruct.hlegend = hlegend;